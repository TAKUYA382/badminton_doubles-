<%= turbo_frame_tag dom_id(match) do %>
  <div class="match-card" data-match-id="<%= match.id %>">
    <div class="match-card__header">
      <span><%= match.round.index %>ÂõûÊà¶</span>
      <span><%= match.court_number %>„Ç≥„Éº„Éà</span>
      <% if match.respond_to?(:gender_label) %>
        <span><%= match.gender_label %></span>
      <% end %>
    </div>

    <div class="match-card__body">
      <table class="table" style="min-width:780px;">
        <thead>
          <tr>
            <th style="width:50%;">„Éö„Ç¢1ÔºàÁ∑®ÈõÜÂèØÔºâ</th>
            <th style="width:50%;">„Éö„Ç¢2ÔºàÁ∑®ÈõÜÂèØÔºâ</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <!-- ===== „Éö„Ç¢1 ===== -->
            <td>
              <% ["pair1_member1", "pair1_member2"].each do |slot_key| %>
                <% mem = match.send(slot_key) %>
                <div class="slot-editor drop-target"
                     data-drop-slot="<%= slot_key %>"
                     data-match-id="<%= match.id %>"
                     data-update-url="<%= update_slot_admin_event_path(match.round.event) %>">
                  <div class="info">
                    <div>
                      <strong><%= mem&.name || "ÔºàÊú™Ë®≠ÂÆöÔºâ" %></strong>
                      <% if mem %>Ôºà<%= mem.grade_label %>„Éª<%= mem.gender_label %>„Éª<%= mem.skill_label %>Ôºâ<% end %>
                    </div>
                  </div>

                  <!-- „ÇØ„É™„Ç¢ -->
                  <%= form_with url: update_slot_admin_event_path(match.round.event), method: :patch, local: true do %>
                    <%= hidden_field_tag :match_id, match.id %>
                    <%= hidden_field_tag :slot_key, slot_key %>
                    <%= hidden_field_tag :clear, "1" %>
                    <button class="btn btn-outline btn-compact" title="„Çπ„É≠„ÉÉ„Éà„ÇíÁ©∫„Å´„Åô„Çã">√ó</button>
                  <% end %>

                  <!-- „Çª„É¨„ÇØ„ÉàÂ∑Æ„ÅóÊõø„Åà -->
                  <%= form_with url: update_slot_admin_event_path(match.round.event), method: :patch, local: true do %>
                    <%= hidden_field_tag :match_id, match.id %>
                    <%= hidden_field_tag :slot_key, slot_key %>
                    <%= select_tag :member_id,
                          options_from_collection_for_select(
                            @drag_members, :id,
                            ->(mm){ "#{mm.name}Ôºà#{mm.grade_label}„Éª#{mm.gender_label}„Éª#{mm.skill_label}Ôºâ" }
                          ),
                          prompt: "ÈÅ∏Êäû„Åó„Å¶Â∑Æ„ÅóÊõø„Åà", class: "select-compact" %>
                    <button class="btn btn-primary btn-compact" title="ÈÅ∏Êäû„ÅßÂ∑Æ„ÅóÊõø„Åà">üîÅ</button>
                  <% end %>

                  <!-- „Éê„ÉÉ„Éï„Ç°„Å´Á©ç„ÇÄÔºà„Åæ„Å®„ÇÅ„Å¶Êõ¥Êñ∞Áî®„ÉªStimulus lineupÔºâ -->
                  <button class="btn btn-outline btn-compact"
                          data-action="click->lineup#bufferReplace"
                          data-match-id="<%= match.id %>"
                          data-slot-key="<%= slot_key %>"
                          data-select-ref="true">
                    ‚è± Â∑Æ„ÅóÊõø„Åà„Çí„Éê„ÉÉ„Éï„Ç°
                  </button>
                </div>
              <% end %>
            </td>

            <!-- ===== „Éö„Ç¢2 ===== -->
            <td>
              <% ["pair2_member1", "pair2_member2"].each do |slot_key| %>
                <% mem = match.send(slot_key) %>
                <div class="slot-editor drop-target"
                     data-drop-slot="<%= slot_key %>"
                     data-match-id="<%= match.id %>"
                     data-update-url="<%= update_slot_admin_event_path(match.round.event) %>">
                  <div class="info">
                    <div>
                      <strong><%= mem&.name || "ÔºàÊú™Ë®≠ÂÆöÔºâ" %></strong>
                      <% if mem %>Ôºà<%= mem.grade_label %>„Éª<%= mem.gender_label %>„Éª<%= mem.skill_label %>Ôºâ<% end %>
                    </div>
                  </div>

                  <!-- „ÇØ„É™„Ç¢ -->
                  <%= form_with url: update_slot_admin_event_path(match.round.event), method: :patch, local: true do %>
                    <%= hidden_field_tag :match_id, match.id %>
                    <%= hidden_field_tag :slot_key, slot_key %>
                    <%= hidden_field_tag :clear, "1" %>
                    <button class="btn btn-outline btn-compact" title="„Çπ„É≠„ÉÉ„Éà„ÇíÁ©∫„Å´„Åô„Çã">√ó</button>
                  <% end %>

                  <!-- „Çª„É¨„ÇØ„ÉàÂ∑Æ„ÅóÊõø„Åà -->
                  <%= form_with url: update_slot_admin_event_path(match.round.event), method: :patch, local: true do %>
                    <%= hidden_field_tag :match_id, match.id %>
                    <%= hidden_field_tag :slot_key, slot_key %>
                    <%= select_tag :member_id,
                          options_from_collection_for_select(
                            @drag_members, :id,
                            ->(mm){ "#{mm.name}Ôºà#{mm.grade_label}„Éª#{mm.gender_label}„Éª#{mm.skill_label}Ôºâ" }
                          ),
                          prompt: "ÈÅ∏Êäû„Åó„Å¶Â∑Æ„ÅóÊõø„Åà", class: "select-compact" %>
                    <button class="btn btn-primary btn-compact" title="ÈÅ∏Êäû„ÅßÂ∑Æ„ÅóÊõø„Åà">üîÅ</button>
                  <% end %>

                  <!-- „Éê„ÉÉ„Éï„Ç°„Å´Á©ç„ÇÄ -->
                  <button class="btn btn-outline btn-compact"
                          data-action="click->lineup#bufferReplace"
                          data-match-id="<%= match.id %>"
                          data-slot-key="<%= slot_key %>"
                          data-select-ref="true">
                    ‚è± Â∑Æ„ÅóÊõø„Åà„Çí„Éê„ÉÉ„Éï„Ç°
                  </button>
                </div>
              <% end %>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
<% end %>